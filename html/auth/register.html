<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register | State Spaces</title>
    <link href="/static/output.css" rel="stylesheet"/>
    <script src="/static/scripts/axios.min.js"></script>
    <script src="/static/scripts/essentials.js"></script>
    <link rel="stylesheet" href="/static/styles/style.css">
</head>
<body>
    <style>
        ::-webkit-calendar-picker-indicator {
            filter: invert(0.6);
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-300 min-h-screen font-sans flex items-center justify-center p-4">

    <main class="w-full max-w-2xl">
        
        <div class="bg-slate-900 border border-slate-800 rounded-2xl shadow-2xl p-8 relative">
            
            <section class="relative z-10">
                <div class="flex items-center gap-4 mb-8">
                    <div class="h-8 w-1.5 bg-emerald-500 rounded-full shadow-lg shadow-emerald-500/50"></div>
                    <div>
                        <h3 class="text-2xl font-bold text-slate-100 font-serif">Register</h3>
                    </div>
                </div>

                <form action="" method="POST" class="space-y-5">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">First Name</label>
                            <input type="text" name="firstname" placeholder="First Name" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Middle Name</label>
                            <input type="text" name="middlename" placeholder="Middle Name" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Last Name</label>
                            <input type="text" name="lastname" placeholder="Last Name" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Birth Date</label>
                            <input type="date" name="birthdate" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Username</label>
                        <input type="text" name="username" placeholder="Enter your username" required
                            class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Password</label>
                            <input type="password" name="password" placeholder="Password" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">Confirm Password</label>
                            <input type="password" name="confirmPassword" placeholder="Confirm" required
                                class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 placeholder-slate-600 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-1.5">
                            <label class="text-xs font-bold text-slate-500 uppercase tracking-widest ml-1">User Type</label>
                            <div class="relative">
                                <select name="usertype" id="usertype"
                                    class="w-full bg-slate-950 border border-slate-800 rounded-lg px-4 py-3 text-sm text-slate-200 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300 appearance-none cursor-pointer">
                                    <option value="0">Customer</option>
                                    <option value="1">Agent</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-slate-500">
                                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-1.5 agent-input hidden">
                            <label class="text-xs font-bold text-emerald-500 uppercase tracking-widest ml-1">Managed Building</label>
                            <div class="relative">
                                <select id="select_bldg" name="managed_bldg"
                                    class="w-full bg-slate-950 border border-emerald-900/50 rounded-lg px-4 py-3 text-sm text-slate-200 focus:outline-none focus:border-emerald-500/50 focus:ring-1 focus:ring-emerald-500/50 transition-all duration-300 appearance-none cursor-pointer">
                                    <option value="" selected disabled hidden>Select Building</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-emerald-500">
                                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pt-2">
                        <input type="submit" value="Sign Up" 
                            class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-3.5 rounded-lg cursor-pointer transition-all duration-300 shadow-[0_0_20px_rgba(16,185,129,0.15)] hover:shadow-[0_0_30px_rgba(16,185,129,0.3)] tracking-wide uppercase text-xs">
                    </div>
                </form>

                <p class="mt-6 text-center text-slate-500 text-xs">
                    Already have an account? 
                    <a href="/login" class="text-emerald-400 hover:text-emerald-300 font-semibold transition-colors border-b border-emerald-500/30 pb-0.5 hover:border-emerald-400">Login here</a>.
                </p>
            </section>
        </div>

    </main>

    <script>
        async function hydrate() {
            try {
                const res = await axios.get('/api/buildings');
                const input_usertype = document.getElementById("usertype");
                const agent_inputs = document.getElementsByClassName("agent-input");
                const select_bldg = document.getElementById("select_bldg");

                res.data.map(bldg => select_bldg.add(new Option(bldg.name, bldg.id), undefined)); 
                
                input_usertype.addEventListener("change", (e) => {
                    for (const input of agent_inputs) {
                        if (e.target.value == 1) {
                            input.classList.remove('hidden');
                        } else {
                            input.classList.add('hidden');
                        }
                    }
                    if (e.target.value == 0) {
                        select_bldg.selectedIndex = 0;
                    }
                });
            } catch (error) {
                console.error(error);
            }
        }
        hydrate();
    </script>
</body>
</html>